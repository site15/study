# üß© –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ storage –≤ System Design

–í System Design –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ **–∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.

---

## 1Ô∏è‚É£ **–¢–∏–ø—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**

| –¢–∏–ø                        | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                          | –ü—Ä–∏–º–µ—Ä—ã                   |
| -------------------------- | ------------------------------------------- | ------------------------- |
| **SQL / —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ**      | —Å—Ç—Ä–æ–≥–∞—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, ACID       | PostgreSQL, MySQL         |
| **NoSQL ‚Äî Document Store** | –≥–∏–±–∫–∞—è —Å—Ö–µ–º–∞, JSON-–¥–æ–∫—É–º–µ–Ω—Ç—ã, –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ | MongoDB, CouchDB          |
| **NoSQL ‚Äî Key-Value**      | —Å–≤–µ—Ä—Ö—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –¥–æ—Å—Ç—É–ø, –∫—ç—à, —Å–µ—Å—Å–∏–∏         | Redis, DynamoDB           |
| **NoSQL ‚Äî Wide Column**    | –º–∏–ª–ª–∏–∞—Ä–¥—ã –∑–∞–ø–∏—Å–µ–π, write-heavy –Ω–∞–≥—Ä—É–∑–∫–∏     | Cassandra, ScyllaDB       |
| **NoSQL ‚Äî Graph DB**       | —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏, —Å–æ—Ü—Å–µ—Ç–∏, –∞–Ω—Ç–∏—Ñ—Ä–æ–¥   | Neo4j, ArangoDB           |
| **Search / Indexing DB**   | –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É, —Ñ–∏–ª—å—Ç—Ä—ã            | Elasticsearch, OpenSearch |

**–°—É—Ç—å:** –≤—ã–±–æ—Ä –±–∞–∑—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏**.

---

## 2Ô∏è‚É£ **–û—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ storage**

### 2.1 **–í—ã–±–æ—Ä —Ç–∏–ø–∞ –±–∞–∑—ã –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É**

* SQL ‚Üí —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å–ª–æ–∂–Ω—ã–µ —Å–≤—è–∑–∏, –æ—Ç—á—ë—Ç—ã
* NoSQL ‚Üí –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –≤—ã—Å–æ–∫–∞—è write-throughput, –≥–∏–±–∫–∞—è —Å—Ö–µ–º–∞

### 2.2 **–®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è**

* **–®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (Partitioning)** ‚Üí –¥–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–ª—é—á—É (userId, tenantId) –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
* **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Üí –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

### 2.3 **–ò–Ω–¥–µ–∫—Å—ã**

* –ò–Ω–¥–µ–∫—Å—ã —É—Å–∫–æ—Ä—è—é—Ç –ø–æ–∏—Å–∫, –Ω–æ –∑–∞–º–µ–¥–ª—è—é—Ç –∑–∞–ø–∏—Å—å
* –í—ã–±–æ—Ä –∏–Ω–¥–µ–∫—Å–æ–≤ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è read-heavy vs write-heavy –Ω–∞–≥—Ä—É–∑–æ–∫

### 2.4 **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**

* Redis / Memcached –¥–ª—è hot data ‚Üí —Å–Ω–∏–∂–∞–µ–º –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π storage
* TTL ‚Üí –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–≤–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 2.5 **Consistency**

* **ACID** (Postgres, MySQL) ‚Üí —Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
* **Eventual consistency** (Cassandra, DynamoDB) ‚Üí –¥–æ–ø—É—Å—Ç–∏–º—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

---

## 3Ô∏è‚É£ **–ü—Ä–æ–¥–∞–∫—à–µ–Ω-–ø–∞—Ç—Ç–µ—Ä–Ω—ã**

### 3.1 **Polyglot Persistence**

* –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –±–∞–∑ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏:

  * SQL ‚Üí user accounts, billing
  * MongoDB ‚Üí chat history, flexible documents
  * Redis ‚Üí —Å–µ—Å—Å–∏–∏, –∫—ç—à
  * Kafka ‚Üí event log / analytics

### 3.2 **CQRS + Event Sourcing**

* Write-DB (source of truth) –∏ Read-DB (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –∑–∞–ø—Ä–æ—Å—ã)
* –°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ ‚Üí —Å—Ç—Ä–æ–∏–º –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤ read-DB

### 3.3 **Hot vs Cold Data**

* Hot ‚Üí –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø, –∫—ç—à + Redis / memory
* Cold ‚Üí –∞—Ä—Ö–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, S3 / object storage

### 3.4 **Partitioning / Sharding**

```text
User messages shard ‚Üí userId % 10
Analytics events shard ‚Üí eventType / time window
```

* –ü–æ–∑–≤–æ–ª—è–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ bottleneck –Ω–∞ –æ–¥–Ω–æ–π –±–∞–∑–µ

---

## 4Ô∏è‚É£ **–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á –Ω–∞ —Å–æ–±–µ—Å–µ**

1. ¬´–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π —á–∞—Ç –Ω–∞ –º–∏–ª–ª–∏–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ö–∞–∫–∏–µ –±–∞–∑—ã –≤—ã–±—Ä–∞—Ç—å?¬ª

   * Hot messages ‚Üí Redis / MongoDB
   * Archive ‚Üí S3 / ClickHouse
   * User profiles ‚Üí Postgres

2. ¬´–ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π —Å —Å—Ç—Ä–æ–≥–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é?¬ª

   * Postgres / MySQL —Å ACID
   * Event log ‚Üí Kafka –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

3. ¬´–£ –Ω–∞—Å spike —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ read-–∑–∞–ø—Ä–æ—Å—ã, –∫–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É?¬ª

   * Read replicas
   * –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis
   * TTL –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è

---

## 5Ô∏è‚É£ **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è —Å–µ–Ω—å–æ—Ä–∞ NestJS**

* **–ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –≤–ª–∞–¥–µ–µ—Ç —Å–≤–æ–µ–π –ë–î** ‚Üí Database per Service (Bounded Context)
* **–ù–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ / –∫–æ–ª–ª–µ–∫—Ü–∏–∏** ‚Üí shard & index –ø—Ä–∞–≤–∏–ª—å–Ω–æ
* **–ò—Å–ø–æ–ª—å–∑—É–π –∫—ç—à –∏ –æ—á–µ—Ä–µ–¥—å** ‚Üí —Ä–∞–∑–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ write-heavy –æ–ø–µ—Ä–∞—Ü–∏–π
* **–ü—Ä–æ–¥—É–º–∞–π retention** ‚Üí archive old data, cold storage
* **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ alerting** ‚Üí slow queries, connection pool, replication lag

---

## 6Ô∏è‚É£ **–¢–∏–ø–æ–≤–æ–π —Å–æ–±–µ—Å–Ω—ã–π –æ—Ç–≤–µ—Ç**

> ¬´–Ø –±—ã —Ä–∞–∑–¥–µ–ª–∏–ª –¥–∞–Ω–Ω—ã–µ –ø–æ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º: Postgres –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, MongoDB –¥–ª—è chat history, Redis –¥–ª—è –∫—ç—à–∞ –∏ —Å–µ—Å—Å–∏–π, Kafka –¥–ª—è —Å–æ–±—ã—Ç–∏–π. –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±—ã —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é, –∞ —Ç–∞–∫–∂–µ read-replicas –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ –Ω–∞ —á—Ç–µ–Ω–∏–µ ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ paging, –¥–ª—è write-heavy ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å—Ç—Ä–æ–≥–æ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ ACID, –∞ –¥–ª—è —Å–æ–±—ã—Ç–∏–π ‚Äî eventual consistency.¬ª
