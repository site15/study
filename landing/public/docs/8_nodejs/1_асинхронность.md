# üß† –û—Å–Ω–æ–≤—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –≤ Node.js

1. **Node.js ‚Äî –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π Event Loop**

   * –ï—Å—Ç—å –æ–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JavaScript.
   * –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç CPU, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ Event Loop.
   * CPU-heavy –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è) –±–ª–æ–∫–∏—Ä—É—é—Ç Event Loop ‚Üí —Ç–æ—Ä–º–æ–∑—è—Ç –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**

   * I/O (—Å–µ—Ç—å, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)
   * –¢–∞–π–º–µ—Ä—ã (`setTimeout`, `setInterval`)
   * –†–∞–±–æ—Ç–∞ —Å –ø–æ—Ç–æ–∫–∞–º–∏ –∏ child_process
   * –ù–µ–∫–æ—Ç–æ—Ä—ã–µ Node.js API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç **callback**, **Promise**, –∏–ª–∏ **async/await**

---

# üîπ –¢—Ä–∏ –±–∞–∑–æ–≤—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

## 1Ô∏è‚É£ **Callbacks**

```js
fs.readFile('file.txt', (err, data) => {
  if (err) throw err;
  console.log(data.toString());
});
```

* –°—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å, prone to **callback hell**
* –°–µ–π—á–∞—Å —á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Promises/async-await

---

## 2Ô∏è‚É£ **Promises**

```js
fs.promises.readFile('file.txt')
  .then(data => console.log(data.toString()))
  .catch(err => console.error(err));
```

* –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å **—Ü–µ–ø–æ—á–∫–∏**, –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å, –Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏

---

## 3Ô∏è‚É£ **Async/Await**

```js
async function readFile() {
  try {
    const data = await fs.promises.readFile('file.txt');
    console.log(data.toString());
  } catch (err) {
    console.error(err);
  }
}
readFile();
```

* –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –Ω–∞–¥ Promise
* –ß–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Event Loop

---

# üîπ Event Loop –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö

1. **Timers** ‚Üí `setTimeout`, `setInterval`
2. **Pending callbacks** ‚Üí –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **Idle, prepare** ‚Üí –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ Node
4. **Poll** ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ–º I/O
5. **Check** ‚Üí `setImmediate`
6. **Close callbacks** ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

> –ö–∞–∂–¥—ã–π —Ü–∏–∫–ª Event Loop ‚Äî **tick**, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Å–µ –≥–æ—Ç–æ–≤—ã–µ –∫–æ–ª–±—ç–∫–∏, –ø–æ—Ç–æ–º —Å–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è.

---

# üîπ –ü—Ä–æ–±–ª–µ–º—ã –∏ –ª–æ–≤—É—à–∫–∏

## 1Ô∏è‚É£ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Event Loop**

```js
// BAD: –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä
const start = Date.now();
while(Date.now() - start < 5000) {}
```

* –†–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å heavy CPU tasks –≤ **Worker Threads** –∏–ª–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å.

---

## 2Ô∏è‚É£ **–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫**

```js
setTimeout(() => console.log('Timeout'), 0);
Promise.resolve().then(() => console.log('Promise'));
console.log('Sync');
```

**–í—ã–≤–æ–¥:**

```
Sync
Promise
Timeout
```

* Promises –∏–¥—É—Ç –≤ **microtask queue**, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ä–∞–Ω—å—à–µ —Ç–∞–π–º–µ—Ä–æ–≤

---

## 3Ô∏è‚É£ **Uncaught errors –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏**

```js
async function fail() {
  throw new Error('oops');
}
fail();
```

* –ë–µ–∑ `catch` ‚Üí `UnhandledPromiseRejectionWarning`
* –í—Å–µ–≥–¥–∞ –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å `await` –≤ try/catch –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.catch()`

---

# üîπ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î –∏ —Å–µ—Ç–µ–≤—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏

### **–ü—Ä–∏–º–µ—Ä: NestJS / PostgreSQL**

```ts
async function getUser(id: string) {
  const user = await prisma.user.findUnique({ where: { id } });
  return user;
}
```

* `await` –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Event Loop
* –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤**:

```ts
const [user, orders] = await Promise.all([
  prisma.user.findUnique({ where: { id } }),
  prisma.order.findMany({ where: { userId: id } }),
]);
```

* –í–∞–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –∏–∑–±–µ–≥–∞–µ–º **overload**

---

# üîπ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

1. **Queue + Worker**

   * RabbitMQ / Kafka / BullMQ
   * Heavy task ‚Üí –ø—É—à–∏–º –≤ –æ—á–µ—Ä–µ–¥—å ‚Üí –≤–æ—Ä–∫–µ—Ä—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç

2. **Batching**

   * –û–±—ä–µ–¥–∏–Ω—è–µ–º –º–µ–ª–∫–∏–µ async –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –±–∞—Ç—á –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è I/O

3. **Timeouts / Retry / Circuit Breaker**

   * –í—Å–µ async –≤—ã–∑–æ–≤—ã –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å **—Ç–∞–π–º–∞—É—Ç –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫**
   * –ò—Å–ø–æ–ª—å–∑—É–µ–º `p-retry` –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã

4. **Throttling / Rate Limiting**

   * –î–ª—è –∑–∞—â–∏—Ç—ã Event Loop –∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

---

# üîπ Debug –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

* `node --inspect` / Chrome DevTools ‚Üí –ø—Ä–æ—Ñ–∏–ª–∏—Ä—É–µ–º Event Loop
* `clinic.js` (Clinic Doctor / Bubbleprof) ‚Üí –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
* Metrics: **latency, queue size, event loop lag**

---

# üîπ –ó–æ–ª–æ—Ç—ã–µ —Ñ—Ä–∞–∑—ã –¥–ª—è —Å–æ–±–µ—Å–∞

> Node.js ‚Äî —ç—Ç–æ –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–π Event Loop, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç I/O –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ª—é–±—ã–µ –¥–æ–ª–≥–∏–µ CPU –∑–∞–¥–∞—á–∏ –Ω—É–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ Worker Threads –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.

> Async/await –∏ Promises ‚Äî —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –Ω–∞–¥ –∫–æ–ª–±—ç–∫–∞–º–∏, –Ω–æ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å **microtask queue vs macrotask queue** –¥–ª—è –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

> –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å Event Loop lag, throttling –∏ retry –ø—Ä–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.

---

# üß† –ö–æ—Ä–æ—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞

| –°—Ü–µ–Ω–∞—Ä–∏–π              | –ö–∞–∫ –¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ               |
| --------------------- | ---------------------------------- |
| –î–æ–ª–≥–∏–π CPU task       | Worker Threads / –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å  |
| –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã  | Promise.all / p-limit              |
| –û—à–∏–±–∫–∞ –≤ async        | try/catch –∏–ª–∏ .catch()             |
| Event Loop –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –Ω–µ –¥–µ–ª–∞—Ç—å while/compute-heavy sync |
| –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á         | RabbitMQ / BullMQ / Kafka          |
