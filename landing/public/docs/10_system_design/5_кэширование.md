# üß© –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ System Design

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —ç—Ç–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö **–≤ –±—ã—Å—Ç—Ä–æ–º –¥–æ—Å—Ç—É–ø–µ**, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –∏ —É—Å–∫–æ—Ä–∏—Ç—å –æ—Ç–∫–ª–∏–∫ —Å–∏—Å—Ç–µ–º—ã.

> –í System Design –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ latency –∏ throughput.

---

## 1Ô∏è‚É£ **–ó–∞—á–µ–º –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å**

1. –£–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

   - –°–µ—Ç—å (API call)
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQL/NoSQL)
   - –°–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è / –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

2. –£—Å–∫–æ—Ä–∏—Ç—å –æ—Ç–∫–ª–∏–∫:

   - –í –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö –≤–º–µ—Å—Ç–æ —Å–æ—Ç–µ–Ω –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥

3. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:

   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å spikes –∏ high QPS

---

## 2Ô∏è‚É£ **–¢–∏–ø—ã –∫—ç—à–µ–π**

| –¢–∏–ø         | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è                      | –ü—Ä–∏–º–µ—Ä—ã                 | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                                |
| ----------- | --------------------------------- | ----------------------- | ------------------------------------------------- |
| In-memory   | –í –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞                  | Node.js Map, LRU cache  | –î–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–¥–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ |
| Distributed | –û–±—â–∏–π –∫—ç—à –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤       | Redis, Memcached        | –ö–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ —á–∏—Ç–∞—é—Ç/–ø–∏—à—É—Ç –æ–¥–∏–Ω –∫—ç—à    |
| CDN / Edge  | –ù–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Å–µ—Ç–∏                   | Cloudflare, Akamai      | –î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –≤–∏–¥–µ–æ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è     |
| Client-side | –í –±—Ä–∞—É–∑–µ—Ä–µ / –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ | localStorage, IndexedDB | –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è UI, —É–º–µ–Ω—å—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä   |

---

## 3Ô∏è‚É£ **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**

### 3.1 **Cache-aside (Lazy loading)**

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à ‚Üí –µ—Å–ª–∏ –Ω–µ—Ç ‚Üí —á–∏—Ç–∞–µ—Ç –∏–∑ –ë–î ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –∫—ç—à

```ts
const getUser = async (id: string) => {
  let user = await redis.get(`user:${id}`);
  if (!user) {
    user = await userRepo.findOne({ id });
    await redis.set(`user:${id}`, JSON.stringify(user), { EX: 3600 });
  } else {
    user = JSON.parse(user);
  }
  return user;
};
```

- **–ü–ª—é—Å—ã:** –∫—ç—à —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ú–∏–Ω—É—Å—ã:** –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –º–µ–¥–ª–µ–Ω–Ω—ã–π, –≤–æ–∑–º–æ–∂–Ω–∞ –ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

### 3.2 **Write-through**

- –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø–∏—à–µ–º **–∏ –≤ –±–∞–∑—É, –∏ –≤ –∫—ç—à**

```ts
await redis.set(`user:${id}`, JSON.stringify(user));
await userRepo.save(user);
```

- **–ü–ª—é—Å—ã:** –∫—ç—à –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª–µ–Ω
- **–ú–∏–Ω—É—Å—ã:** write latency –≤—ã—à–µ

---

### 3.3 **Write-back / Write-behind**

- –°–Ω–∞—á–∞–ª–∞ –ø–∏—à–µ–º —Ç–æ–ª—å–∫–æ –≤ –∫—ç—à ‚Üí —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –±–∞–∑–æ–π

- **–ü–ª—é—Å—ã:** –±—ã—Å—Ç—Ä—ã–π write, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É

- **–ú–∏–Ω—É—Å—ã:** —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ–µ, —Å–ª–æ–∂–Ω–µ–µ –ª–æ–≥–∏–∫–∞

---

### 3.4 **TTL –∏ Eviction Policies**

- TTL (Time To Live) ‚Üí –¥–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- Eviction policies ‚Üí —á—Ç–æ —É–¥–∞–ª–∏—Ç—å, –∫–æ–≥–¥–∞ –∫—ç—à –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω:

  - LRU (Least Recently Used)
  - LFU (Least Frequently Used)
  - FIFO

---

## 4Ô∏è‚É£ **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö**

1. **Read-heavy —Å–µ—Ä–≤–∏—Å—ã**:

   - –ü—Ä–∏–º–µ—Ä—ã: –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–∞—Ç–∞–ª–æ–≥–∏ —Ç–æ–≤–∞—Ä–æ–≤, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º Redis/Memcached

2. **Event-driven —Å–∏—Å—Ç–µ–º—ã**:

   - –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º TTL + invalidation —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `UserUpdated`)

3. **High QPS / spike traffic**:

   - –ö—ç—à–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
   - –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

---

## 5Ô∏è‚É£ **–ü—Ä–æ–¥–∞–∫—à–µ–Ω-–ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ —Å–æ–≤–µ—Ç—ã**

- **Cache + DB consistency**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è / TTL / write-through
- **Cache stampede**: –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ–¥–∏–Ω –∫–ª—é—á ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **lock / request coalescing**
- **Monitoring**: cache hit ratio ‚Üí —á–µ–º –≤—ã—à–µ, —Ç–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ

---

## 6Ô∏è‚É£ **–ü—Ä–∏–º–µ—Ä NestJS + Redis**

```ts
@Injectable()
export class UserService {
  constructor(
    private readonly userRepo: UserRepository,
    private readonly redis: RedisService
  ) {}

  async getUser(id: string) {
    const key = `user:${id}`;
    let user = await this.redis.get(key);
    if (!user) {
      user = await this.userRepo.findOne({ id });
      await this.redis.set(key, JSON.stringify(user), { EX: 3600 });
    } else {
      user = JSON.parse(user);
    }
    return user;
  }
}
```

- **–ö—ç—à —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ** ‚Üí Cache-aside pattern
- **TTL 3600 —Å–µ–∫—É–Ω–¥** ‚Üí –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞—Ä–µ–≤–∞—é—Ç

---

## 7Ô∏è‚É£ **–ß—Ç–æ —Å–ø—Ä–æ—Å—è—Ç –Ω–∞ —Å–æ–±–µ—Å–µ**

1. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É **Cache-aside, Write-through –∏ Write-back**
2. –ö–∞–∫ **–æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –∫—ç—à–µ–º –∏ –±–∞–∑–æ–π**
3. Eviction policies –∏ TTL, –ø–æ—á–µ–º—É –Ω—É–∂–Ω—ã
4. –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å **cache stampede**
5. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö / –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö**

---

### ‚úÖ –ò—Ç–æ–≥

- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî **–∫–ª—é—á–µ–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω System Design**, —Å–Ω–∏–∂–∞–µ—Ç latency –∏ –Ω–∞–≥—Ä—É–∑–∫—É
- –í NestJS / Node.js ‚Üí Redis / Memcached + TTL + invalidation —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è
- –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å **trade-offs**: –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Å–≤–µ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
