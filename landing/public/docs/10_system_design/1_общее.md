# üß© System Design –¥–ª—è —Å–µ–Ω—å–æ—Ä–æ–≤ Node.js / NestJS

---

## 1Ô∏è‚É£ **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (Requirements & Scale)**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Ç–æ—á–Ω—è—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ:

  - QPS (queries per second) / TPS (transactions per second)
  - Latency requirements (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
  - Storage needs (–æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö, retention)
  - SLA / SLO (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å)

**–ü—Ä–∏–º–µ—Ä —Å–æ–±–µ—Å–∞:**

- ¬´–°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π —Å–∏—Å—Ç–µ–º—É –¥–ª—è —á–∞—Ç–∞ –Ω–∞ 1 –º–ª–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø–æ–∏—Å–∫–æ–º¬ª

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **—Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ / –Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ**
- –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ (back-of-the-envelope calculation)

---

## 2Ô∏è‚É£ **API / Gateway / BFF**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- REST vs gRPC vs GraphQL
- API Gateway –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- Backend-for-Frontend (BFF) –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–ü—Ä–æ–¥–∞–∫—à–µ–Ω-–ø—Ä–∏–º–µ—Ä:**

- NestJS microservices ‚Üí gateway, auth, user, chat-service
- –†–∞–∑–Ω—ã–µ BFF ‚Üí Web + Mobile

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –¢—ã –ø–æ–Ω–∏–º–∞–µ—à—å **–≥–¥–µ –≥—Ä–∞–Ω–∏—Ü—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤** –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω gateway

---

## 3Ô∏è‚É£ **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ storage**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- SQL (PostgreSQL) vs NoSQL (MongoDB, Redis, Cassandra)
- –ò–Ω–¥–µ–∫—Å—ã, —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
- Transaction management (ACID vs eventual consistency)

**–ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:**

- ¬´–ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?¬ª
- ¬´–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQL, –∫–æ–≥–¥–∞ NoSQL?¬ª

**–ü—Ä–æ–¥–∞–∫—à–µ–Ω-–ø–æ–¥—Ö–æ–¥:**

- PostgreSQL ‚Üí user accounts, relationships
- MongoDB ‚Üí chat history (document store)
- Redis ‚Üí –∫—ç—à / –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á

---

## 4Ô∏è‚É£ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- Redis / Memcached
- Cache aside / Read-through / Write-through
- TTL –∏ eviction policies

**–ü—Ä–∏–º–µ—Ä—ã:**

- –ö—ç—à –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
- –ö—ç—à –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –≤–Ω–µ—à–Ω–µ–º—É API

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –ü–æ–Ω–∏–º–∞–Ω–∏–µ **trade-offs**: stale data, cache invalidation, consistency

---

## 5Ô∏è‚É£ **–û—á–µ—Ä–µ–¥–∏ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- RabbitMQ / Kafka / NATS / Redis Streams
- Pub/Sub vs Work Queue
- DLQ, backpressure, retry

**–ü—Ä–∏–º–µ—Ä—ã:**

- –û—á–µ—Ä–µ–¥—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push/email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Kafka –¥–ª—è event sourcing / analytics

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –ö–∞–∫ **—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—É—é —Å–∏—Å—Ç–µ–º—É**, handle spikes –∏ retry

---

## 6Ô∏è‚É£ **Load Balancing & Scaling**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ vs –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- Round-robin / Least connections / Sticky sessions
- Kubernetes + Node.js deployment patterns
- Stateless vs Stateful —Å–µ—Ä–≤–∏—Å—ã

**–ü—Ä–∏–º–µ—Ä—ã:**

- NestJS cluster + PM2 / k8s pods + Haproxy/Nginx LB
- Scaling chat-service –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É** –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å trade-offs

---

## 7Ô∏è‚É£ **Sharding –∏ Partitioning**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –ø–æ userId / tenantId
- Partitioning Kafka topics / Redis streams

**–ü—Ä–∏–º–µ—Ä—ã:**

- User messages ‚Üí shard –ø–æ tenantId –∏–ª–∏ userId
- Analytics events ‚Üí Kafka partitioning

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –ü–æ–Ω–∏–º–∞–Ω–∏–µ **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è**

---

## 8Ô∏è‚É£ **Consistency & Transactions**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- ACID vs BASE
- Eventual consistency / Saga pattern
- Distributed transactions (2PC) vs local transactions + compensation

**–ü—Ä–∏–º–µ—Ä:**

- –ó–∞–∫–∞–∑ ‚Üí —Ä–µ–∑–µ—Ä–≤ —Å–∫–ª–∞–¥–∞ ‚Üí –æ–ø–ª–∞—Ç–∞ ‚Üí –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è ‚Üí email
- –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ ‚Üí –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º —Ä–µ–∑–µ—Ä–≤

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –ö–∞–∫ —Ç—ã **–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—à—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

---

## 9Ô∏è‚É£ **Search / Indexing**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- Elasticsearch / Algolia / Postgres full-text search
- –ò–Ω–¥–µ–∫—Å—ã, inverted index, sharding

**–ü—Ä–∏–º–µ—Ä—ã:**

- –ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∏–º–µ–Ω–∏/–ø–æ—á—Ç–µ

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **–≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –ø–æ–¥ –∑–∞–¥–∞—á—É**

---

## üîü **Monitoring / Observability**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- –ú–µ—Ç—Ä–∏–∫–∏: latency, QPS, error rate
- –õ–æ–≥–∏: structured logs, correlation IDs
- Tracing: Jaeger, OpenTelemetry
- Alerts & dashboards: Prometheus + Grafana

**–ü—Ä–∏–º–µ—Ä:**

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ Event Loop lag –≤ NestJS —Å–µ—Ä–≤–∏—Å–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π RabbitMQ / Kafka lag

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **–æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –≤ –ø—Ä–æ–¥–µ**

---

## 1Ô∏è‚É£1Ô∏è‚É£ **High-Level Architecture Patterns**

- Microservices
- Event-driven architecture
- CQRS + Event Sourcing
- API Gateway + BFF

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –¢—ã –ø–æ–Ω–∏–º–∞–µ—à—å **trade-offs –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π**, –æ–±—ä—è—Å–Ω—è–µ—à—å –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã

---

## 1Ô∏è‚É£2Ô∏è‚É£ **Security & Reliability**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å:**

- Auth: JWT, OAuth2, API keys
- Rate limiting / Throttling
- Retry + Circuit Breaker + Bulkhead
- Secrets management, TLS, encryption

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç:**

- –£–º–µ–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç—å **–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã**

---

## 1Ô∏è‚É£3Ô∏è‚É£ **–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–æ–±–µ—Å–µ**

1. –°–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π —Å–∏—Å—Ç–µ–º—É —á–∞—Ç–∞ –Ω–∞ –º–∏–ª–ª–∏–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. –ö–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∏—Å–∫–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π?
3. –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å?
4. –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (push/email) —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏?
5. –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –ø–æ–¥—Å–∏—Å—Ç–µ–º—É –Ω–∞ –º–∏–ª–ª–∏–æ–Ω–∞—Ö —Å–æ–±—ã—Ç–∏–π?
6. –û–±—ä—è—Å–Ω–∏, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à, –æ—á–µ—Ä–µ–¥–∏, –±—Ä–æ–∫–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–µ
7. –ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å spike —Ç—Ä–∞—Ñ–∏–∫–∞ –±–µ–∑ –ø–∞–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã?

---

# üîπ –†–µ–∑—é–º–µ

**–ß—Ç–æ —Ç–æ—á–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç —Å–µ–Ω—å–æ—Ä—É:**

- –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **—Ä–∞–∑–¥–µ–ª—è—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã**
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ trade-offs –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –≤—ã–±–æ—Ä–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è **latency, throughput, storage**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, –æ—á–µ—Ä–µ–¥–∏, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, Saga, eventual consistency
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, retry / circuit breaker / backpressure
